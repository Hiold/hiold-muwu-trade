import{A as a,G as e,E as t,L as i,r as d,o as r,c as l,f as o,k as s,g as m,t as n}from"./vendor.e2554b35.js";import"./moment.08a7f518.js";import{_ as c}from"./AawrdComponent.7d3777ad.js";const u={name:"ShopManage",components:{AawrdComponent:c},mounted(){this.ctx=a(),this.initTableData()},data:()=>({fid:"1",cid:"",awardAddVisible:!1,customData:0,md1:"md1",imglist:null,allIcon:[],queryData:null,awardInfo:null,rules:{itemType:[{required:!0,trigger:"blur",message:"请选择物品类型"}]},formData:{id:"",timestart:"",timeend:"",startdate:"",enddate:"",desc:"",type:"1"},instance:!1,editor:"",ctx:{},addVisible:!1,itemNameCache:[]}),methods:{handleAvatarSuccess(){e({message:"上传成功!",type:"success"}),this.initIconData()},handleAvatarFaild(){e.error("上传失败"),this.initIconData()},initIconData(){t.post("api/getIconFile",{itemname:""}).then((a=>{if("1"===a.data.respCode){let e=a.data.data;this.allIcon=e}}))},handleDelete(a){i.confirm("确定要删除这个商品吗？").then((i=>{if("confirm"===i){let i={id:a+""};t.post("api/deleteDailyAward",i).then((a=>{"1"===a.data.respCode?e({message:"删除成功!",type:"success"}):e.error("删除失败"),this.initTableData()}))}})).catch((()=>{}))},initTableData(){t.post("api/getDailyAward",{itemname:""}).then((a=>{if("1"===a.data.respCode){let e=a.data.data;this.queryData=e}}))},submitForm(a){this.$refs[a].validate((a=>{if(!a)return!1;{let a="";a="-1"==this.formData.id?"api/postDailyAward":"api/updateDailyAward",this.formData.startdate||(this.formData.startdate=""),this.formData.enddate||(this.formData.enddate=""),this.formData.timestart||(this.formData.timestart=""),this.formData.timeend||(this.formData.timeend=""),t.post(a,this.formData).then((a=>{"1"===a.data.respCode?e({message:"保存成功!",type:"success"}):e.error("保存出错"),this.addVisible=!1,this.initTableData()}))}}))},openUpdate(a){this.addVisible=!0,this.formData.id=a.row.id+"",this.formData.startdate=a.row.startdate,this.formData.enddate=a.row.enddate,this.formData.timestart=a.row.timestart,this.formData.timeend=a.row.timeend,this.formData.desc=a.row.desc,this.formData.type=a.row.type},openAddUpdate(a){this.awardAddVisible=!0,this.awardData.id=a.row.id+"",this.awardData.type=a.row.type+"",this.awardData.containerid=a.row.containerid+"",this.awardData.count=a.row.count+"",this.awardData.itemname=a.row.itemname+"",this.awardData.itemquality=a.row.itemquality+"",this.awardData.itemchinese=a.row.itemchinese+"",this.awardData.itemicon=a.row.itemicon+"",this.awardData.itemtint=a.row.itemtint+"",this.awardData.command=a.row.command+"",this.awardData.couCurrType=a.row.couCurrType+"",this.awardData.couPrice=a.row.couPrice+"",this.awardData.couCond=a.row.couCond+"",this.awardData.coudatelimit=a.row.coudatelimit+"",this.awardData.couDateStart=a.row.couDateStart+"",this.awardData.couDateEnd=a.row.couDateEnd+"",this.awardData.couDate=[this.awardData.couDateStart,this.awardData.couDateEnd],this.selectspeitem=this.awardData.itemname},openAwardEdit(a){this.$store.state.awardEditVisible=!0,this.cid=a.row.id},resetForm(a){this.$refs[a].resetFields()},discountchange(){this.formData.prefer=(parseInt(this.formData.price)*(this.formData.discount/10)).toFixed(2)+""},preferchange(){parseInt(this.formData.prefer)>parseInt(this.formData.price)&&(this.formData.price=this.formData.prefer,this.formData.discount=10),this.formData.discount=(parseInt(this.formData.prefer)/parseInt(this.formData.price)*10).toFixed(2)},catchs(a){},handleAdd(){this.formData.id="-1",this.addVisible=!0},handleAddAward(){this.awardData.id="-1",this.awardAddVisible=!0},loadCouCurr(a,e){e([{value:"积分折扣"},{value:"积分满减"},{value:"钻石折扣"},{value:"钻石满减"}])}}},f={class:"crumbs"},h=o("i",{class:"el-icon-lx-cascades"},null,-1),D=m(" 基础表格 "),p={class:"container"},w={class:"handle-box"},b=m("添加"),y=m("编辑红包 "),V=m("编辑奖品 "),C=m("删除 "),g=m(" 至 "),_=m(" 至 "),A={class:"dialog-footer"},v=m("确 定"),k=m("取 消"),Y=m("重 置");u.render=function(a,e,t,i,c,u){const I=d("el-breadcrumb-item"),U=d("el-breadcrumb"),F=d("el-button"),M=d("el-table-column"),H=d("el-table"),T=d("el-option"),x=d("el-select"),E=d("el-form-item"),q=d("el-input"),S=d("el-date-picker"),j=d("el-time-picker"),z=d("el-form"),$=d("el-dialog"),P=d("AawrdComponent");return r(),l("div",null,[o("div",f,[o(U,{separator:"/"},{default:s((()=>[o(I,null,{default:s((()=>[h,D])),_:1})])),_:1})]),o("div",p,[o("div",w,[o(F,{type:"success",icon:"el-icon-plus",onClick:u.handleAdd},{default:s((()=>[b])),_:1},8,["onClick"])]),o(H,{border:"",class:"table",ref:"multipleTable","header-cell-class-name":"table-header",data:c.queryData},{default:s((()=>[o(M,{prop:"id",label:"ID",width:"55",align:"center"}),o(M,{label:"红包名称"},{default:s((a=>[m(n(a.row.desc),1)])),_:1}),o(M,{label:"红包类型"},{default:s((a=>[m(n("1"==a.row.type?"普通每日红包":"2"==a.row.type?"单次领取红包":"未知错误配置"),1)])),_:1}),o(M,{label:"红包名称有效期"},{default:s((a=>[m(n(""==a.row.startdate?"即日起":a.row.startdate.substring(0,10))+" 至 "+n(""==a.row.enddate?"长期有效":a.row.enddate.substring(0,10)),1)])),_:1}),o(M,{label:"红包可领取时间段"},{default:s((a=>[m(n(""==a.row.timestart?"即刻起":a.row.timestart)+" 至 "+n(""==a.row.timeend?"全天有效":a.row.timeend),1)])),_:1}),o(M,{label:"操作",width:"350",align:"center"},{default:s((a=>[o(F,{type:"primary",icon:"el-icon-edit",size:"small",onClick:e=>u.openUpdate(a)},{default:s((()=>[y])),_:2},1032,["onClick"]),o(F,{type:"success",icon:"el-icon-edit",size:"small",onClick:e=>u.openAwardEdit(a)},{default:s((()=>[V])),_:2},1032,["onClick"]),o(F,{type:"delete",icon:"el-icon-delete",size:"small",class:"red",onClick:e=>u.handleDelete(a.row.id)},{default:s((()=>[C])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])]),o($,{title:"新增",modelValue:c.addVisible,"onUpdate:modelValue":e[10]||(e[10]=a=>c.addVisible=a),width:"40%","append-to-body":!0},{footer:s((()=>[o("span",A,[o(F,{type:"primary",onClick:e[7]||(e[7]=a=>u.submitForm("formData"))},{default:s((()=>[v])),_:1}),o(F,{onClick:e[8]||(e[8]=a=>c.addVisible=!1)},{default:s((()=>[k])),_:1}),o(F,{onClick:e[9]||(e[9]=a=>u.resetForm("formData"))},{default:s((()=>[Y])),_:1})])])),default:s((()=>[o(z,{rules:c.rules,ref:"formData",model:c.formData},{default:s((()=>[o(E,{label:"红包类型",class:"center"},{default:s((()=>[o(x,{modelValue:c.formData.type,"onUpdate:modelValue":e[1]||(e[1]=a=>c.formData.type=a),placeholder:"货币种类",class:"handle-space"},{default:s((()=>[o(T,{key:"1",label:"普通每日红包",value:"1"}),o(T,{key:"2",label:"单次领取红包",value:"2"})])),_:1},8,["modelValue"])])),_:1}),o(E,{label:"红包名称",class:"center"},{default:s((()=>[o(q,{class:"handle-space",placeholder:"请输入红包名称",modelValue:c.formData.desc,"onUpdate:modelValue":e[2]||(e[2]=a=>c.formData.desc=a)},null,8,["modelValue"])])),_:1}),o(E,{label:"红包有效期",class:"center"},{default:s((()=>[o(S,{modelValue:c.formData.startdate,"onUpdate:modelValue":e[3]||(e[3]=a=>c.formData.startdate=a),align:"right",type:"date",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",placeholder:"默认即日起"},null,8,["modelValue"]),g,o(S,{modelValue:c.formData.enddate,"onUpdate:modelValue":e[4]||(e[4]=a=>c.formData.enddate=a),align:"right",type:"date",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",placeholder:"结束日期"},null,8,["modelValue"])])),_:1}),o(E,{label:"可领取时段",class:"center"},{default:s((()=>[o(j,{modelValue:c.formData.timestart,"onUpdate:modelValue":e[5]||(e[5]=a=>c.formData.timestart=a),format:"HH:mm:ss","value-format":"HH:mm:ss",placeholder:"任意时间点"},null,8,["modelValue"]),_,o(j,{format:"HH:mm:ss","value-format":"HH:mm:ss",modelValue:c.formData.timeend,"onUpdate:modelValue":e[6]||(e[6]=a=>c.formData.timeend=a),placeholder:"任意时间点"},null,8,["modelValue"])])),_:1})])),_:1},8,["rules","model"])])),_:1},8,["modelValue"]),o(P,{fid:c.fid,cid:c.cid},null,8,["fid","cid"])])};export default u;
